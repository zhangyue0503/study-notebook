<html>
<head>
  <title>MySQL必知必会</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/608449 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
	body, td {
	  font-family: 微软雅黑;
	  font-size: 12pt;
	}
  </style>
</head>
<body>
<a name="2852"/>
<h1>MySQL必知必会</h1>

<div>
<span><div><span style="font-weight: bold; font-size: 24px;">一、了解SQL</span></div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">二、MySQL简介</span></div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">三、使用MySQL</span></div><div>1.SHOW DATABASES;返回可用数据库的一个列表</div><div>2.SHOW TABLES;返回当前选择的数据库内可用表的列表</div><div>3.SHOW COLUMNS FROM &lt;t&gt;;返回行中的字段</div><div>4.SHOW STATUS;显示服务器状态信息</div><div>5.SHOW CREATE DATABASE和SHOW CREATE TABLE，分别显示创建特定数据库或表的MYSQL语句</div><div>6.SHOW GRANTS，用来显示授予用户的安全权限</div><div>7.SHOW ERRORS和SHOW WARNINGS，用来显示服务器错误或警告信息</div><div>8.HELP SHOW;显示允许的SHOW语句</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">四、检索数据</span></div><div>1.SELECT DISTINCT &lt;column&gt;，指示MySQL只返回不同的值，不能部分使用DISTINCT，DISTINCT应用于所有列而不仅是前置它的列，如果给出两个列，除非指定的两个列都不同，否则所有行都将被检索出来</div><div>2.MySQL5支持 LIMIT 4 OFFSET 3 的写法</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">五、排序检索数据</span></div><div>1.关系数据库设计理论认为，如果不明确规定排序顺序，则不应该假定检索出的数据的顺序有意义</div><div>2.子句（clause），SQL语句由子句构成，有些子句是必需的，有些是可选的，一个子句通常由一个关键字和所提供的数据组成</div><div>3.在字典排序顺序中，A被视为与a相同，这是MySQL（和大多数数据库管理系统）的默认行为</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">六、过滤数据</span></div><div>1.WHERE &lt;column&gt; IS NULL;，检查具有NULL值的列</div><div>2.NULL，无值（no value）,与字段包含0、空字符串或仅仅包含空格不同</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">七、数据过滤</span></div><div>1.MySQL支持使用NOT对IN、BETWEEN和EXISTS子句取反</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">八、使用通配符进行过滤</span></div><div>1.LIKE指示MySQL，后跟的搜索模式利用通配符匹配而不是直接相等匹配进行比较</div><div>2.%不能匹配用值NULL作为产品名的行</div><div>3._只匹配单个字符而不是多个字符</div><div>4.使用通配符的技巧：不要过度使用；在确实需要使用通配符时，除非绝对有必要，否则不要把它们用在搜索模式的开始处；仔细注意通配符的位置</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">九、用正则表达式进行搜索</span></div><div>1.MySQL仅支持多数正则表达式实现的一个很小的子集</div><div>2.WHERE &lt;column&gt; REGEXP ‘rex’；</div><div>3.LIKE匹配整个列，如果被匹配的文本在列值中出现，LIKE将不会找到它，相应的行也不被返回（除非使用通配符）。而REGEXP在列值内进行匹配，如果被匹配的文本在列值中出现，REGEXP将会找到它，相应的行将被返回</div><div>4.默认不区分大小写，如果需要区分，可以使用BINARY关键字</div><div>5.匹配特殊字符使用\\</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">十、创建计算字段</span></div><div>1.Concat()拼接串，即把多个串连接起来形成一个较长的串</div><div>2.RTrim()、LTrim()、Trim()清除空格</div><div>3.AS，定义别名，也叫导出列</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">十一、使用数据处理函数</span></div><div>1.函数没有SQL的可移植性强</div><div>2.文本处理函数：</div><ul><li>RTrim()</li><li>Soundex()返回串的语音表示的字母数字模式算法</li><li>SubString()返回子串</li><li>Upper()将串转换为大写</li></ul><div>3.日期和时间处理函数：</div><ul><li>AddDate()增加一个日期（天、周等）</li><li>AddTime()增加一个时间（时、分等）</li><li>CurDate()返回当前日期</li><li>CurTime()返回当前时间</li><li>Date()返回日期时间的日期部分</li><li>DateDiff()计算两个日期之差</li><li>Date_Add()高度灵活的日期运算函数</li><li>Date_Format()返回一个格式化的日期或时间串</li><li>Day()返回一个日期的天数部分DayOfWeek()返回对应的星期几</li><li>Hour()返回一个时间的小时部分</li><li>Minute()返回一个时间的分钟部分</li><li>Month()返回一个日期的月份部分</li><li>Now()返回当前日期和时间</li><li>Second()返回一个时间的秒部分</li><li>Time()返回一个日期时间的时间部分</li><li>Year()返回一个日期的年份部分</li></ul><div>4.如果要的仅是日期，请使用Date()</div><div>5.数值处理函数：</div><ul><li>Abs()返回一个数的绝对值</li><li>Cos()返回一个角度的余弦</li><li>Exp()返回一个数的指数值</li><li>Mod()返回除操作的余数</li><li>Pi()返回圆周率</li><li>Rand()返回一个随机数</li><li>Sin()返回一个角度的正弦</li><li>Sort()返回一个数的平方根</li><li>Tan()返回一个角度的正切</li></ul><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">十二、汇总数据</span></div><div>1.聚集函数（aggregate function）运行在行组上，计算和返回单个值的函数</div><div>2.AVG()函数返回某列的平均值</div><div>3.COUNT()函数返回某列的行数</div><div>4.MAX()函数返回某列的最大值</div><div>5.MIN()函数返回某列的最小值</div><div>6.SUM()函数返回某列值之和</div><div>7.对所有的行执行计算，指定ALL参数或不给参数</div><div>8.只包含不同的值，指定DISTINCT参数；DISTINCT必须使用列名，不能用于计算或表达式</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">十三、分组数据</span></div><div>1.GROUP BY的一些规定：</div><ul><li>GROUP BY子句可以包含做生意数目的列</li><li>如果GOURP BY子句中嵌套了分组，数据将在最后规定的分组上进行汇总</li><li>GROUP BY子句中列出的每个列都必须是检索列或有效的表达 式（但不能是聚集函数）</li><li>除聚集计算语句外，SELECT语句中的每个列都必须在GROUP BY子句中给出</li><li>如果分组列中具有NULL值，则NULL将作为一个分组返回</li><li>GROUP BY子句必须出现在WHERE子句之后，ORDER BY子句之前</li></ul><div>2.使用WITH ROLLUP关键字，可以得到每个分组以及每个分组汇总级别（针对每个分组）的值</div><div>3.WHERE过滤行，HAVING过、 滤分组，WHERE在数据分组前进行过滤，HAVING在数据分组后进行过滤</div><div>4.一般在使用GROUP BY子句时，应该也给出ORDER BY子句，这是保证数据正确排序的唯一方法，千万不要仅依赖GROUP BY排序数据</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">十四、使用子查询</span></div><div>1.在WHERE子句中使用子查询，应该保证SELECT语句具有与WHERE子句中相同数目的列</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">十五、联结表</span></div><div>1.外键（foreign key）外键为某个表中的一列，它包含另一个表的主键列，定义了两个表之间的关系</div><div>2.由没有联结条件的表关系返回的结果为笛卡尔积，检索出来的行的数目将是第一个表中的行数乘以第二个表中的行数</div><div>3.内部联结，基于两个表之间的相等测试，也称为等值联结</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">十六、创建高级联结</span></div><div>1.自联结，在单条SELECT语句中不止一次引用相同的表，通常作为外部语句用来替代从相同表中检索数据时使用的子查询语句</div><div>2.外部联结，包含没有关联行的那些行，在使用时，必须使用RIGHT或LEFT指定包括其所有行的表</div><div>3.关于联结及其使用的要点：</div><ul><li>注意所使用的联结类型</li><li>保证使用正确的联结条件，否则将返回不正确的数据</li><li>应该总是提供联结条件，否则会得出笛卡尔积</li><li>在一个联结中可以包含多个表，甚至对于每个联结可以采用不同的联结类型</li></ul><div><br/></div><div><b><font style="font-size: 24px;">十七、组合查询</font></b></div><div>1.有两种情况需要使用组合查询：在单个查询中从不同的表返回类似结构的数据；对单个表执行多个查询，按单个查询 返回数据；</div><div>2.使用UNION操作符来组合数条SQL查询，可以给出多条SELECT语句，将它们的结果组合成单个结果集</div><div>3.对于复杂的过滤条件，或者从多个表中检索数据的情形，使用UNION可能会使处理更简单</div><div>4.UNION规则 ：</div><div><ul><li>UNION必须 由两条或两条以上的SELECT语句组成，语句之间用关键字UNION分隔<br/></li><li>UNION中的每个查询必须包含相同的列、表达式或聚集函数<br/></li><li>列数据类型必须兼容：类型不必完全相同，但必须 是DBMS可以隐含地转换的类型<br/></li></ul></div><div>5.UNION自动去除了重复的行，如果想返回所有的行，可以使用UNION ALL</div><div>6.在使用UNION组合查询时，只能使用一条ORDER BY子句，必须出现在最后一条SELECT语句之后</div><div><br/></div><div><b><font style="font-size: 24px;">十八、全文本搜索</font></b></div><div>1.InnoDB不支持全文本搜索</div><div>2.为了进行全文搜索，必须索引被搜索的列，而且要随着数据的改变不断地重新索引，在对表列进行适当设计后，MySQL会自动进行所有的索引和重新索引</div><div>3.使用FULLTEXT在CREATE TABEL时创建全文搜索</div><div>4.不要在导入数据时使用FULLTEXT，应该首先导入所有数据，然后再修改表，定义FULLTEXT</div><div>5.使用Match()和Against()进行全文搜索，Match()指定被搜索的列，Against()指定要使用的搜索表达式</div><div>6.传递给Match()的值必须与FULLTEXT()定义中的相同，如果指定多个列，则必须 列出它们，而且次序正确</div><div>7.全文搜索的一个重要部分就是对结果排序，具有较高等级的行先返回</div><div>8.使用查询扩展时，MySQL对数据和索引进行两遍扫描来完成搜索，能找出可能相关的结果，即使它们并不精确包含所查找的词，表中的行越多，使用查询扩展返回的结果就越好Against(xxx WITH QUERY EXPANSION)</div><div>9.布尔文本搜索（boolean mode），Against(xxx IN BOOLEAN MODE)，可以在没有FULLTEXT索引的列上使用，是一种非常缓慢的操作</div><div><br/></div><div><b><font style="font-size: 24px;">十九、插入数据</font></b></div><div>1.一般不要使用没有明确给出列的列表的INSERT语句，使用列的列表能使SQL代码继续发挥作用，即使表结构发生了变化</div><div>2.省略的列必须满足：该列定义为允许NULL值；在表定义中给出默认值</div><div>3.使用LOW_PRIORITY，可以降低INSERT语句的优先级，如INSERT LOW_PRIORITY INTO ….</div><div>4.MySQL用单条INSERT语句处理多个插入比使用多条INSERT语句快</div><div>5.INSERT SELECT，将一条SELECT语句的结果插入表中，由一条INSERT语句和一条SELECT语句组成，不要求列名，INSERT只关心列的位置</div><div><br/></div><div><b><font style="font-size: 24px;">二十、更新的删除数据</font></b></div><div>1.在使用UPDATE和DELETE时一定要注意细心，不要省略WHERE语句</div><div>2.使用IGNORE，即使是发生了错误，也继续更新，UPDATE IGNORE 表名....</div><div>3.想删除表中所有的行，可使用TRUNCATE TABLE语句，速度更快</div><div>4.更新和删除的指导原则：</div><ul><li>除非确实想更新和删除每一行，否则绝对不要使用不带WHERE子句的UPDATE或DELETE语句</li><li>保证每个表都有主键，心可能像WHERE子句那样使用它</li><li>在对UPDATE和DELETE语句使用WHERE子句前，应该先用SELECT进行测试，保证它过滤的是正确的记录</li><li>使用强制实施引用完整性的数据库，这样MySQL将不允许删除具有与其他表相关联的数据的行</li></ul><div>5.MySQL没有撤销，应该非常小心地使用UPDATE和DELETE</div><div><br/></div><div><b><font style="font-size: 24px;">二十一、创建和操纵表</font></b></div><div>1.关于CREATE TABLE，必须给出下列信息：</div><div><ul><li>新表的名字，在关键字CREATE TABLE之后给出<br/></li><li>表列的名字和定义，用逗号分隔<br/></li></ul></div><div>2.使用IF NOT EXISTS，检查表名是否存在，并且仅在表名不存在时创建它</div><div>3.使用last_insert_id()获取最后一个AUTO_INCREMENT值</div><div>4.MySQL不允许使用函数作为默认值，它只支持常量，这么多数据库开发人呗使用默认值而不是NULL列</div><div>5.使用ENGINE指定引擎，包括InnoDB、MEMORY、MyISAM，外键不能跨引擎</div><div>6.使用ALTER TABEL语句更新表 ：</div><div><ul><li>在ALTER TABLE之后给出要更改的表名<br/></li><li>所做更改的列表<br/></li></ul></div><div>7.使用ALTER TABLE要极为小心，应该在进行改动前做一个完事的备份</div><div>8.使用DROP TABLE语句删除表</div><div>9.使用RENAME TABLE语句可以重命名一个表，RENAME TABLE xxx1 TO xxx2</div><div><br/></div><div><b><font style="font-size: 24px;">二十二、使用视图</font></b></div><div>1.视图的应用：</div><div><ul><li>重用SQL语句<br/></li><li>简化复杂的SQL操作<br/></li><li>使用表的组成部分而不是整个表<br/></li><li>保护数据 <br/></li><li>更改数据格式和表示<br/></li></ul></div><div>2.视图仅仅是用来手机如何查看存储在别处数据的一种设施，本身并不包含数据 ，是从其他表里检索出来的，在添加或更改这些表中的数据时，视图将返回改变过的数据</div><div>3.视图规则和限制：</div><div><ul><li>必须唯一命名<br/></li><li>对于可以创建的视图数目没有限制<br/></li><li>为了创建视图，必须有足够的访问权限<br/></li><li>视图可以嵌套，即可以利用从其他视图中检索数据的查询来构造一个视图<br/></li><li>ORDER BY可以用在视图中，但如果视图中包含ORDER BY，则视图中的ORDER BY将被覆盖<br/></li><li>视图不能索引 ，也不能有关联的触发器或默认值<br/></li><li>视图可以和表一起使用<br/></li></ul></div><div>3.使用CREATE VIEW语句创建视图，CREATE VIEW xxxx AS ……</div><div>4.创建不受特定数据限制的视图是一种好办法，扩展视图的范围不仅使得它能被重用，而且甚至更有用，这样做不需要创建和维护多个类似视图</div><div>5.视图对于简化计算字段的使用特别有用</div><div>6.视图是可更新的，但如果MySQL不能正确地确定被更新的基数据，则不允许更新（包括插入和删除），如果视图定义中有这些操作，则不能进行视图更新（分组：使用GROUP BY和HAVING、联结、子查询、并、聚集函数：Min(),Count(),Sum()等、DISTINCT、导出(计算)列）</div><div><br/></div><div><b><font style="font-size: 24px;">二十三、使用存储过程</font></b></div><div>1.存储过程简单来说，就是为以后的使用而保存的一条或多条MySQL语句的集合，可以视为批文件，但它们的作用不仅限于批处理</div><div>2.使用的理由：</div><div><ul><li>通过把处理封装在容易使用的单元中，简化复杂的操作<br/></li><li>由于不要求反复建立一系列处理步骤，保证了数据的完整性<br/></li><li>简化对变动的管理<br/></li><li>提高性能，使用存储过程比使用单独的SQL语句要快<br/></li><li>存在一些只能用在单个请求中的MySQL元素和特性，存储过程可以使用它们来编写功能更强更灵活的代码<br/></li></ul></div><div>3.缺陷：</div><div><ul><li>存储过程的编写比基本SQL语句复杂，编写存储过程需要更高的技能，更丰富的经验<br/></li><li>需要权限<br/></li></ul></div><div>4.执行存储过程：CALL xxxxxx(@a,@b,@c)</div><div>5.创建存储过程：CREATE PROCEDURE xxxx() BEGIN xxxx END;</div><div>6.如果命令行要解释存储过程自身内的;字符，则它们最终不会成为存储过程的成分，这会使存储过程中的SQL出现语法错误，使用DELIMITER临时更改语句分隔符</div><div>7.删除存储过程：DROP PROCEDURE xxx;</div><div>8.MySQL支持IN（传递给存储过程）、OUT（从存储过程传出）、INOUT（对存储过程传入和传出）</div><div><br/></div><div><b><font style="font-size: 24px;">二十四、使用游标</font></b></div><div>1.游标（cursor）是一个存储在MySQL服务器上的数据库查询，它不是一条SELECT语句，而是被该语句检索出来的结果集，在存储了游标之后，应该程序可以根据需要滚动或浏览其中的数据，只能用于存储过程，主要用于交互式应该</div><div>2.使用游标的步骤：</div><div><ul><li>在能够使用游标前，必须声明（定义）它<br/></li><li>一旦声明后，必须 打开游标以供使用<br/></li><li>对于填有数据的游标，根据需要取出（检索）各行<br/></li><li>在结束游标使用时，必须关闭游标<br/></li></ul></div><div>3.创建游标：使用DECLARE语句命名游标，并定义相应的SELECT语句</div><div>4.打开关闭游标：OPEN xxxx;   CLOSE xxx;</div><div>5.使用FETCH语句分别访问它的每一行，指定检索什么数据（所需的列），检索出来的数据存储在什么地，它还向前移动游标中的内部行指针，使下一条FETCH语句检索下一行</div><div><br/></div><div><b><font style="font-size: 24px;">二十五、使用触发器</font></b></div><div>1.触发器是MySQL响应以下任意语句而自动执行的一条MySQL语句（或位于BEGIN和END语句之间的一组语句）：DELETE、INSERT、UPDATE</div><div>2.创建触发器时：</div><div><ul><li>唯一的触发器名<br/></li><li>触发器关联的表<br/></li><li>触发器应该响应的活动（DELETE、INSERT、UPDATE）<br/></li><li>触发器何时执行（处理之前或之后）<br/></li></ul></div><div>3.使用语句CREATE TRIGGER语句创建，只有表才支持触发器，视图不支持，临时表也不支持，按每个表每个事件每次地定义</div><div>4.使用DROP TRIGGER删除触发器</div><div>5.在触发器代码内，可以引用OLD和NEW虚拟表</div><div><br/></div><div><b><font style="font-size: 24px;">二十六、管理事务处理</font></b></div><div>1.MyISAM不支持事务处理</div><div>2.事务处理（transaction processing）可以用来维护数据库的完整性，它保证成批的MySQL操作要么完全执行，要么完全不执行</div><div>3.几个术语：事务（transaction）、回退（rollback）、提交（commit）、保留点（savepoint）</div><div>4.使用START TRANSACTION标识事务开始</div><div>5.使用ROLLBACK回退（撤销）MySQL语句，可以回退INSERT、DELETE、UPDATE语句</div><div>6.一般的MySQL语句都是直接针对数据库表执行和编写的，就是隐含提交（implicit commit），即提交操作是自动进行的，但在事务处理块中，提交不会隐含地进行，必须使用COMMIT语句提交</div><div>7.使用SAVEPOINT保留点，支持回退部分事务处理，可以回退到某个保留点，事务处理完成会自动释放，也可以用RELEASE SAVEPOINT明确地释放保留点</div><div>8.设置SET autocommit=0，禁止自动提交</div><div><br/></div><div><b><font style="font-size: 24px;">二十七、全球化和本地化</font></b></div><div>1.使用SHOW CHARACTER SET;查看所支持的字符集列表</div><div>2.字符集转换使用Cast()或Convert()函数</div><div><br/></div><div><b><font style="font-size: 24px;">二十八、安全管理</font></b></div><div>1.用户不能对过多的数据具有过多的访问权：</div><div>2.在日常工作中，决不能使用root，应该创建一系列的帐号，有的用于管理，有的供用户使用，有的供开发人员使用</div><div>3.创建用户帐号，CREATE USER xxx IDENTIFIED BY ‘xxx’，IDENTIFIED BY为口令，重新命名一个用户帐号RENAME USER xxx TO xxx，删除用户帐号DROP USER</div><div>4.显示帐号权限SHOW GRANTS FOR，设置权限GRANT语句，设置权限需要给出：要授予的权限、被授予访问权限的数据库或表、用户名</div><div>5.撤销权限REVOKE</div><div>6.GRANT和REVOKE可在几个层次上控制访问权限：</div><div><ul><li>整个服务器，使用GRANT ALL和REVOKE ALL<br/></li><li>整个数据库，使用ON database.*<br/></li><li>特定的表，使用ON database.table<br/></li><li>特定的列<br/></li><li>特定的存储过程<br/></li></ul></div><div>7.更改用户口令，使用SET PASSWORD，新口令必须传递到PASSWORD()函数进行加密</div><div><br/></div><div><b><font style="font-size: 24px;">二十九、数据库维护</font></b></div><div>1.备份方式：</div><div><ul><li>使用命令行程序mysqldump转储所有数据库内容到某个外部文件<br/></li><li>可用命令行程序 mysqlhotcopy从一个数据库复制所有数据<br/></li><li>可以使用MySQL的BACKUP TABLE或SELECT INTO OUTFILE转储所有数据到某个外部文件，可以使用RESTORE TABLE来复原<br/></li></ul></div><div>2.在血盆前使用FLUSH TABLES保证所有数据被写到磁盘</div><div>3.ANALYZE TABLE检查表键是否正确，CHECK TABLE用来针对 这么多问题对表进行检查，REPAIR TABLE修复访问产生不正确和不一致结果的表，不应该经常使用，OPTIMIZE TABLE收回表所用空间，优化表性能</div><div>4.使用日志时，可用FLUSH LOGS语句来刷新和重新开始所有日志文件</div><div><br/></div><div><b><font style="font-size: 24px;">三十、改善性能</font></b></div><div>1.生产数据库应该运行在自己的专用服务器上</div><div>2.使用SHOW VARIABLES;和SHOW STATUS;查看MySQL配置</div><div>3.使用SHOW PROCESSLIST显示所有活动进程（以及它们的线程和执行时间），可以用KILL命令终结某个特定的进程</div><div>4.使用EXPLAIN语句让MySQL解释它将如何执行一条SELECT语句</div><div>5.一般来说，存储过程比一条一条地执行其中的各条语句快</div><div>6.总是使用正确的数据类型</div><div>7.不要检索比需要还要多的数据（SELECT *）</div><div>8.必须索引数据库表以改善数据检索的性能</div><div>9.将OR换成UNION语句</div><div>10.索引提升查询性能，但会损害数据插入、删除和更新的性能</div><div>11.LIKE很慢</div></span>
</div></body></html> 