<html>
<head>
  <title>《WEB之困-现代WEB应用安全指南》</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/608449 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
	body, td {
	  font-family: 微软雅黑;
	  font-size: 12pt;
	}
  </style>
</head>
<body>
<a name="631"/>
<h1>《WEB之困-现代WEB应用安全指南》</h1>

<div><span><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">二</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">URL</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">8</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期二</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">下午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2:37</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 14pt; font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">构建基于用户输入的全新</span><span style="font-size: 14pt;-en-paragraph:true;"> </span><span style="font-size: 14pt; font-weight: bold; font-family: Calibri;-en-paragraph:true;">URL</span><span style="font-size: 14pt;-en-paragraph:true;"> </span><span style="font-size: 14pt; font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">时</span><span style="font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">如果允许用户构造 URL 的路径</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">、查询或片段</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">ID 这几部分</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">如果其中一部分未能正确地进行转义，这种</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL 很可能会产生出人意料的结果</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">（</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">例如</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，假造一个用户可见的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTML 按扭</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，令它和一个服务器端的处理关联起来）。这里宁可选择保守的做法：那哪里需要插入攻击者能控制的字段值，除了字母和数字，最好把所有的数据都按百分号编码形式转义一下。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">如果允许用户提供协议名称或授权信息部分数据：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">这会带来严重的代码注入和钓鱼风险！请采用以下列出的输入验证。
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">设计</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">URL 输入过滤器</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">相对 URL</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">禁用相对</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，或明确</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">地改写成绝对路径以避免麻烦</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。其他方式fjtb很可能有风险。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">协议名称：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">只允许出现可接受的几种协议类型，例如</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">http://</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">https://</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">和</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">ftp://</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。不要使用黑名单的验证方式，这是非常不安全的。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">授权信息部分：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">主机名部分应该只包含数字</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">字母以及“-”和“.”</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，在它的后面只能跟着“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">/</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”、“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">?</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”、“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">#</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”或字符串结束符。允许其他任何数据都有可能带来风险。如果需要检查主机名，请确保合理地使用从左往左的截取匹配模式。</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 在很罕见的情况下</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，可能还需要检查</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL 里的 IDNA</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">IPv6 括号表示法</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、商品号或</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTP 验证授权信息等</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。如果确实需要，必须</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">对整个 URL 进行彻底的解析</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，验证各个部分，拒绝不正常的值，重新把整个</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL 序列化成一个没有歧义</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，符合规范，经过恰当</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">转义的表达形式</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">需要从接收到的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">URL 里进行参数解码</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">千万不要因为标准是这么说的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，浏览器也应是这么做的，就想当然地认为特定的字符就一定会被转义。在返回任何从</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL 获取的数值或把它放入数据库进行查询前</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，拼接成新的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL 前</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，都需要仔细严谨地过滤清理危险的字符。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">三</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">HTTP</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">8</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期二</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">下午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2:17</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 14pt; font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">处理</span><span style="font-size: 14pt;-en-paragraph:true;"> </span><span style="font-size: 14pt; font-weight: bold; font-family: Calibri;-en-paragraph:true;">Content-Disposition</span><span style="font-size: 14pt;-en-paragraph:true;"> </span><span style="font-size: 14pt; font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">头域里用户提供的文件名</span><span style="font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">如果不需要用到非拉丁语系文件名</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">则只需保留字母数字符号和“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">.</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”、“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">-</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”和“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">_</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”，其他字符</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">一概移除或替换掉</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。为保护用户免遭有害或具欺骗性文件名的可能性，至少要保证文件名的首字符是字母或数字，并把最后一个句号之外的其他句号一律用其他字符（如下划线）替代。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 要时刻记住</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，允许引号、分号、反斜杠、控制字符（</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">0x00~0x1F</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">）的出现</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">可能导致安全隐患</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">如果需要用到非拉丁语系的文件名：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">应该按照</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">RFC2047</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">RFC2231或根据浏览器的使用情况使用百分号编码的 URL 形式作为文件名</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。确保过滤控制字符（</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">0x00~0x1F</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">）和对任何分号、反斜杠和引号进行转义。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">处理</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">HTTP Cookies 里的用户输入信息</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">对字母和数字以外的所有字符进行百分号编码</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">更好的做法是，干脆用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Base64 编码</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。那些引号、控制字符（</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">0x00~0x1F</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">）、高位字符（</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">0x80~0xFF</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">）、逗号、分号、反斜杠，都有可能导致</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Cookie 注入</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，或使当前</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Cookie 的含义和范围发生变化</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">发送由用户提供的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">Location 头域</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">参见第二章</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。应对提供的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL 进行解析和规范化处理</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，确保</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL 对应的塘田市镇 在允许的白名单里</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，以及重定向到指定的主机是安全的。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 确保任何控制字符和高位字符都恰当地进行了转义</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。主机名部分需使用</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Punycode 编码</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，除此以外的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL 其余部分</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，则需采用百分号编码方式。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">构建</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">其他类别的用户输入请求或响应</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">进行语法检查</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">，排队头域可能引致的副作用。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">常规来说，要尤其注意控制字符、高位字符、逗号、引号、反斜杠和分号；其它字符或字串可能在某些个案上会有影响。要根据需要，对这些字符进行转义或替换处理。</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">创建新的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">HTTP 客户端</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">、服务器或代理</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">时</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">不要全新地开发自己的实现方式，除非</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">真的迫不得已</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。在踫到模棱两可的语法解析时，如果可能，不要理会</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">RFC 里那些货币于容忍错误的建议和消极回避的处理</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">四</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">HTML</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">8</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期二</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">下午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12:38</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><h1 style="font-size: 14pt; color: rgb(63, 63, 63);"><span style="font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;">对各种</span><span style="font-size: 14pt; color: rgb(63, 63, 63);"> </span><span style="font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold; font-family: Calibri;">HTML</span><span style="font-size: 14pt; color: rgb(63, 63, 63);"> </span><span style="font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;">文档均适用的良好规范</span><span style="font-size: 14pt; color: rgb(63, 63, 63);">
</span></h1><ul style="direction: ltr; unicode-bidi: embed;"><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">确保输出统一的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">、有效的、浏览器支持的</span> <span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">Content-Type 响应头及其 charset 字符集信息</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">，以避免文档未按其原意进行解析</span></div></li></ul><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold;-en-paragraph:true;">HTML 文档里包含由攻击者控制的信息时</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; color: rgb(63, 63, 63); margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; color: rgb(63, 63, 63);-en-paragraph:true;">   </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; color: rgb(63, 63, 63);-en-paragraph:true;"> 这项任务在整个Web应用里很难完全保持统一</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; color: rgb(63, 63, 63);-en-paragraph:true;">，而这也恰好是</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; color: rgb(63, 63, 63);-en-paragraph:true;">Web应用安全漏洞的主要成因</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; color: rgb(63, 63, 63);-en-paragraph:true;">。</span></div><ul style="direction: ltr; unicode-bidi: embed;"><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-weight: bold; font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">针对文本部分里的用户提供内容</span><span style="font-weight: bold; font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">：</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">总是用实体编码方式处理“</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">&lt;</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">”、“</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">&gt;</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">”和“</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">&amp;</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">”。另外值得注意的是，在某些</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">ASC2格式不兼容的输出编码中</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">，会有一些额外的模式也是危险的。</span></div></li><ul style="direction:ltr;unicode-bidi:embed;" type="circle"><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">要记住，某些</span> <span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">Unicode 元字符</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">（如</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">U+202E</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">）可能会改变之后文本的显示方向或顺序。在非常敏感的环境里，删掉这些字符可能会列合理些。</span></div></li></ul><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-weight: bold; font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">针对</span> <span style="font-weight: bold; font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">style 和 on* 标签的参数</span><span style="font-weight: bold; font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">：</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">需要做多重编码转义处理。但这种做法非常容易</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">出错</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">，也就是说可能没有效果。</span></div></li><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-weight: bold; font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">所有其他的</span> <span style="font-weight: bold; font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">HTML 参数值</span><span style="font-weight: bold; font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">：</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">对攻击者能控制的输入总是用引号括起来。对“”、“”、“”以及任何单独出现</span> <span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">的引号都要进行实体编码</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">。要记住，对某些参数需要做额外的验证。</span></div></li><ul style="direction:ltr;unicode-bidi:embed;" type="circle"><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">不要对</span> <span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">URL 或其他参数里有问题的值做黑名单验证</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">，这么做可能适得其反，导致脚本执行漏洞。</span></div></li></ul><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-weight: bold; font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">特殊的解析模式</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">（例如</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">&lt;script&gt;和&lt;style&gt;区块里的内容</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">）：在用双引号括起来的字符串里，要对引号字符串、“”、“”和所有非打印字符都应该以对应语言所适用的转义方式进行处理。在没有用引号括起的部分，更要加倍小心，只允许出现经过仔细校验、能明确</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">识别的内容或只能为数字字母类型的数据</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">。</span></div></li><ul style="direction:ltr;unicode-bidi:embed;" type="circle"><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">在</span> <span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">XHTML 模式里</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">，要记得把整个脚本段落置于</span> <span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">CDATA 区块内</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">。避免出现</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">多重编码的情况</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">，这样可能由于参数的拼接导致</span> <span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">JavaScript eval(...) 里最后执行了攻击者提供的字符串</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">。不要把用户提供的数据放在</span> <span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">HTML 注释</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">、</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">!类型或?类型的标签里</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">，也不要放在其他非正统或非常规的解析区块里。</span></div></li></ul></ul><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold;-en-paragraph:true;">从</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63);-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold;-en-paragraph:true;">HTML 转化为纯文本</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63);-en-paragraph:true;">
</span></div><ul style="direction: ltr; unicode-bidi: embed;"><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">一个常见的错误就是只处理了格式正确的标签</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">。请记住，即使没有匹配的右尖括号，所有的左尖括号也都是必须移除的。为降低错误带来的风险，在输出显示时也应该对尖括号和</span> <span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">&amp; 符号进行实体编码</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">。</span></div></li></ul><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold;-en-paragraph:true;">为用户提供的内容开发一个标记</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold;-en-paragraph:true;">（</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold;-en-paragraph:true;">Markup</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold;-en-paragraph:true;">）</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold;-en-paragraph:true;">过滤器时</span></div><ul style="direction: ltr; unicode-bidi: embed;"><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">使用一个足够强壮的 HTML 解析器</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">，在内存里先创建文档树映像。遍历文档树，移除任何无法识别或不需要的标签和参数，去除不需要的标签</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">/参数/参数值组合</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">。</span></div></li><ul style="direction:ltr;unicode-bidi:embed;" type="circle"><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">完成后，对文档重新做序列化处理，确保对参数值和文本内容进行恰当</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">的转义处理</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">。也要留意对特殊解析模式的处理。</span></div></li></ul><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">由于命名空间与</span> <span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">JavaScript 的互动方式与直觉相左</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">，在用户提供的标记里应禁止出现</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt; mso-spacerun: yes;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;"> name 和 id 参数</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">。</span></div></li><li style="vertical-align: middle; color: rgb(63, 63, 63);"><div><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11.0pt;">不要试图就地清理一个经过序列化处理的现有文档，这么做不可避免地会带来安全问题。</span></div></li></ul><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; color: rgb(63, 63, 63); margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; color: rgb(63, 63, 63);-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">五</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">CSS</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">8</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期二</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">下午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2:53</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">要加载远程样式表时</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">这是把自身站点的安全性与远程样式表所在域名的安全性关联到一起</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。即使浏览器不支持在样式表里使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">JavaScript 表达式</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，通过运用条件选择器和引用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">url(...)</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，也能使黑客获知站点的部分信息</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">如果有疑问，宁可先在本地保存一份副本再使用
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">在</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTPS 站点里</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，要引用的样式表也必须使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTPS 协议</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">CSS 里包含攻击者控制的信息时</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">在独立区块里的字符串和 URL</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">要尽量使用引号括起来。对所有控制字符</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">（</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">0x00~0x1F</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">）</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">和 “\”</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">&lt;</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”、“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">&gt;</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”、“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">{</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”、“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">}</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”和单双引号这些字符，都需要使用数字编码形式的转义处理，使用数字编码形式的转义编码时要用引号括起来。对高位字符也要尽量使用转义处理。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">在 style 参数值中的字符串</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">涉及多重转义的问题。这个处理非常容易出错，所以除非</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">绝对必要</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，尽量不要这么做。如果无可避免，必须先用上一条</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">CSS 转义规则进行处理</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，再对结果进行</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTML 参数编码</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">非字符串型的属性。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">用白名单方式设置关键字只能由字母数字组成，并对数字型的值进行严格验证。不能只拦截已知的有害模式。
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">过滤用户提供的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">CSS 时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">移除在功能性规则集以外的所有内容</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。不得保存或产生由用户控制的注释区块、</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">@指令等</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">严格验证选择器语法，只允许出现</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">数字</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、字母、下划线、空格；在“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">{</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”前的冒号、点号和逗号位置要正确。不要允许匹配复杂文本格式的选择器，因为复杂选择器不太安全。</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">解析和校验</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">在 {...} 区块进而的每条规则</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。以白名单方式设定允许的属性，这些属性的效果应不会产生歧义，并确认这些属性只接收符合预期、已明确为安全的值。值得注意的是，字符串在被赋给某些属性时，尽管没有用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">url(...) 形式的设定</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，但也可能会按</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL 方式解析</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">对每个参数编码，消除任何不正常的语法。
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">请记住，除非</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">有特别的限制</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，否则</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">CSS 可以把用户的内容旋转到绘图区域之外</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，或者重新定义</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Web 应用里任何区域的 UI 外观</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。要避免这些问题，最稳妥的做法是把不受信任的内容单独放在一个框架里显示出来。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">在</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">HTML 标记里允许用户设定 Class 值时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">确保用户提供的 CSS 设置</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，不会和网站</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">UI 已用到的任何 Class 重名</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。如果无法把不信任内容都放到一个独立的框架里，建议尽量使用独立的命名空间前缀。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">六</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、浏览器端脚本</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">9</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期三</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">上午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">10:59</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">加载远程脚本时</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">和</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">CSS 一样</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，这么做是把自身站点的安全性寄托在远程脚本所在网站</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">的安全上了</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。如果存疑，还是先保存为本地数据的副本再使用吧。在</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTPS 站点里</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，要引用的脚本也应当使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTPS 协议</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">解析从服务器端收到的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">JSON 数据时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">如果可以</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，尽量使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">JSON.parse(...)</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。不要用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">eval(...) 或 RFC 4627 里提供的基于 eval 的实现</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。特别是在处理第三方返回数据时，这两种方式都不安全。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">RFC 4627 的作者后来提供的 json2.js 实现也许还算可行</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">JavaScript 代码块里包含用户提供数据的几种情况</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">在 &lt;script&gt; 代码块里的字符串</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">对所有控制字符（</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">0x00~0x1F</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">）和</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">“/”</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">&lt;</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”和“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">&gt;</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”还有引号，都要用反斜杠加数字形式的转义处理。对高位字符也要尽量进行转义处理。</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 不要直接拿用户提供的字符串组成动态 HTML</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。要选择安全的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">DOM 处理</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，如</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">innerText 或 createTextNode(...)</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。不要直接拿用户提供的字符串组成参数传进有脚本执行功能的函数里；尽量避免使用</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">eval(...)</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">setTimeout(...) 等写法</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">在独立脚本文件里的独立的字符串：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">参见对</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">&lt;script&gt; 代码块的要求</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。如果脚本包含任何敏感的用户相关信息，要考虑跨站脚本包含的风险；可以在</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">JavaScript 文件的开头位置加入 “)}]'\n”字符</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，以命名</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">JavaScript 解析器挂掉</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">；或至少使用一个合理的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">JSON 序列化方式</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，而不要单纯只靠填充或其他的调整方式来防范风险。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">在事件处理器或</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">javascript</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">格式的伪</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL 里</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">：在这些位置出现</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">用户提供的数据时</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，需要做多重转义。尽量不要用这种直接内嵌</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">JavaScript 脚本的方式</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，因为很容易</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">出错</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。如果非得这么做，首先应用一次</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">JavaScript 转义</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，然后根据情况对转义后的内容再应用一次</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTML 或 URL 参数编码方式</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。造成不要在这种情况下使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">eval(...)</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">setTimeout(...) 和 innerHTML</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">非字符串型的属性：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">用白名单方式设置关键字只能由字母和数字组成，并对数字型的数据</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">进行严格验证</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。不能只拦截已知的有害模式。</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">与客户端浏览器对象交互时</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">在客户端产生的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">HTML 内容</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">不要使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">innerHTML</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">document.write(...) 或类似的有问题的处理</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，它们往往会出人意料地导致跨站脚本漏洞。构建</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> HTML 文档时</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，请使用安全的函数：如</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">createElement(...) 和 appendChild(...)</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，安全的属性：如</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">innerText 或 textContent</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">对用户控制数据的处理：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">要预设从浏览器端读取的任何数据都未经过正确的转义，特别是</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">location 属性和其他一些涉及外部 URL 来源的数据</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，这些数据往往不太统一，每种浏览器的具体实现也会有差异。一定要自己再进行转义处理。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">如果页面能加载其他用户控制的脚本</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">这种情况实际上没法真正安全。
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">七</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、非</span><span style="font-size: 20pt;-en-paragraph:true;"> </span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">HTML 类型文档</span><span style="font-size: 20pt;-en-paragraph:true;">
</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">9</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期三</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">上午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">11:56</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">提供</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">XML 文档格式时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 要假设需要处理的数据很可能会被解析为 XHTML 格式或其他支持脚本的文档类型</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，不要只根据</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Type 响应头和最顶层 xmlns 指令进行判断</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。不要在文档任意位置上允许出现可由攻击者控制的不受限制</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">的标记语言</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。如果不需要直接访问该文件，可以在相应的响应头里加入</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Disposition: Attachment; 这种方式不会影响 &lt;img&gt; 和订阅源的使用</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">对所有非</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">HTML 文档的类型</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 使用正确的浏览器能识别的 Content-Type 响应头和设置正确的字符集编码</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。如果可能，指定</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Disposition: attachment</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。验证和限制输出内容的语法。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">八</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、浏览器插件产生的内容</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">10</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期四</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">上午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">11:15</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">提供需要让插件处理的文件时</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">对来自信任源的数据：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">通常存放来自信任源的数据是安全的，但要记住</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Flash</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Java 和 Silverlight 小程序或 Adobe Reader JavaScript 引擎本身也有漏洞的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，也有可能影响站点的安全性。避免在插件执行的小程序里处理用户提供的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，也不要在这些小程序里产生或修改由用户控制的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTML 代码</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。当使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">JavaScript 作为 HTML 和插件的桥接方式时</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，一定要加倍小心。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">用户控制的简单的多媒体：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">存放用户提供的多媒体</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">文件相对来说是安全的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，但要验证和限制</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">文件的格式</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，要使用正确的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Type 设置</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，以避免内容检测引致的安全漏洞。</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">用户控制的文档格式：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">存放用户控制的文档本质上来说是能做到安全的。但由于插件自身的设计漏洞，它们可能会增加安全隐患。如果可能，请考虑把用户提交的内容放在专用域名上。如果需要对独立的域名进行授权访问，请使用单次有效的令牌字符方式，而不要使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Cookie 的方式</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">用户控制的活动应用：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">在敏感的域名上存放这类文件是不安全的。
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">需要嵌入由插件处理的文件</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 请确保在 HTTPS 站点上的插件也是通过 HTTPS 方式加载的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，确保永远明确地在</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">&lt;object&gt; 和 &lt;embed&gt; 里设定 type 参数</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。请注意由于有时候</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">type 参数无法被识别</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，所以在页面上嵌入来自非信任源的插件内容时需要加以必要的限制，特别</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">是在高度敏感的站点上</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">简单多媒体：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">只要遵从上述这条总体性的建议，一般来说从第三方加载简单多媒体</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">文件是安全的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">办公文档格式：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">通常来说是安全的，但它们比简单的多媒体</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">文件会带来更多潜在的插件和浏览器内容处理问题</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。请小心使用。</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">Flash 和 Silverlight</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">理论上来说，只要在标记语言里做好了安全相关的标签设置，从外部来源嵌入</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Flash 和 SilverLight 应用是安全的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。但如果这些安全相关的标签设置不当，则有可能把站点的安全性拱手交托给插件所在的站点方了。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">Java 小程序</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Java 小程序总是会把本站点的安全性交托给内容提供方所在的站点</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，因为无法可靠地限制</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Java 小程序访问所在页面的 DOM</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。不要加载非信任站点的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Java 程序</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">如果希望开发一个新的浏览器插件或</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">ActiveX 组件</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 除非要解决一个非常重要且具通用性的问题</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，能使互联网上大量的使用者获益，否则请务必三思而行。如果真的打算从头构建</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">一套全新的功能</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，请根据同行意见，按标准的方式采用</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTML5 开发</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">九</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、内容隔离逻辑</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">10</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期四</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">上午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">11:38</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">对全部站点都要使用可靠的安全策略</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 为保护用户</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，应该在最顶层的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">crossdomain.xml 文件设定 permitted-cross-domain-policies 参数项为 master-only 或者 by-content-type</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，即使在这个站点上根本没有用到</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Flash</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。这么做是为了阻止</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">由攻击者控制的无关内容被错误地当作另一个 crossdomian.xml 文件</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，以致损害了那些支持</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Flash 的浏览器的同源策略</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">当依赖于</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">HTTP Cookies 做身份认证时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">使用 httponly 标签</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">；设计</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Web 应用时谨记不要让 JavaScript 发货如u访问到身份授权的 Cookie 信息</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。需要把敏感</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Cookie 的有效范围设置得越小越好</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，最好不要指定</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Cookie 的 domain 值</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">如果应用是完全基于</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTPS 的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，那</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Cookie 就应该标记为 secure</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，而且必须对</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Cookie 注入有完善的处理</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">（</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTP 运行环境可能导致标记为 secure 的 Cookie 被覆盖</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，即使无法被读取。）对</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Cookie 进行加密签名也许能防范这种超出控制的篡改行为</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，但也仍然无法阻止</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">受害者的 Cookie 被替换成另一组由合法方式获取的 Cookie 身份</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">处理</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">JavaScript 里的跨域通信时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">不要用 document.domain</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。只要有可能，尽量使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">postMessage(...)</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，确保对目标源的设置正确；收到数据时要验证发送端的源。对域名的判断不要使用过于简单的截断匹配方式：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">msg.origin.indexOf(&quot;.</span><a href="http://example.com" style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">example.com</a><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">&quot;) 这是非常不安全的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">警惕各种在</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">postMessage 之前的同源绕过伎俩</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，譬如依赖于</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><a href="http://window.name" style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">window.name</a><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 并不保险</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，在交换敏感数据时不能使用这种方式。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">内嵌插件处理的第三方动态内容时</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Flash</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">：除非</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">完全信任 Flash 原属域名和该服务器的安全性</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，否则不要设定</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">allowScriptAccess=always</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。在</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTPS 页面里内置来自 HTTP 的 Flash 程序时</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，也不要做此设定。另外如果</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">适用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，也请尽量不用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">allowFullScreen 和 allowNetworking</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Silverlight</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">：和上一条相类似，陫完全信任原属服务器，否则不要设定</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">enableHtmlAccess=true</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">提供以插件方式执行的内容时</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">注意许多由浏览器插件提供的跨域通信机制</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">都有出人意料之外的后果</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。特别是，要避免</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">crossdomain.xml</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">clientaccesspolicy.xml 或 allowDomain(...) 规则指向无法完全信任的域名</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">开发浏览器端扩展时</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">避免使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">innerHTML</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">document.write(...)</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">eval(...) 和其他容易出错的代码模式</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，它们可能导致在第三方页面或特权</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">JavaScript 执行模式下的代码注入</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">不要把检查</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">非受信 JavaScript 安全执行环境</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，作为安全有关的关键性决定的判断依据，因为它们的表现有时候可能带有欺骗性质。</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">十</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、源的继承</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">11</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期五</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">上午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">11:53</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 11pt; font-family: Calibri; mso-spacerun: yes;-en-paragraph:true;">      </span><span style="font-size: 11pt;-en-paragraph:true;"> </span><span style="font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">因为与同源策略的不兼容</span><span style="font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">，在使用</span><span style="font-size: 11pt;-en-paragraph:true;"> </span><span style="font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">data:</span><span style="font-size: 11pt;-en-paragraph:true;"> </span><span style="font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、</span><span style="font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">javascript: 以及隐式或显式的 about:blank URL 时一定要加倍小心</span><span style="font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">。如果无需特别顾虑</span><span style="font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">性能问题</span><span style="font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">，宁可派生出新框架或者窗口，指向由服务器端提供的空白页面，这样从一开始就有明确</span><span style="font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">的源信息</span><span style="font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">。</span><span style="font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 要谨记不能随便地用 data: 和 javascript: URL 替代 about:blank</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，只有在绝对必要的情况下，才使用这两种伪</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">URL</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。特别是，一厢情愿地预设</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">data: 窗口不会被跨域访问到</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，是非常不安全的做法。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">十一</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、同源策略之外的世界</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">14</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期一</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">下午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">4:55</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">所有网站</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">都适用的安全准则</span></div><div style="color: rgb(0, 0, 0); font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">网站 上所有的内容都应该使用</span><span style="color: rgb(0, 0, 0); font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: Calibri;-en-paragraph:true;">X-Frame-Options: sameorigin</span><span style="color: rgb(0, 0, 0); font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">响应头</span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">。根据实际情况，只对那些有特定用途，明确无误地确实需要被跨站嵌入的地址才做例外处理。尽量不要使用</span><span style="color: rgb(0, 0, 0); font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">JavaScript 的“破除框架”代码来防止页面在框架里被引用</span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">，因为这种代码并不十分可靠。</span><span style="color: rgb(0, 0, 0); font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">在返回不应被跨域使用的用户相关敏感数据时，要使用明确设定的格式，避免错误地被当作</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">独立的脚本</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、样式表或其他类型的文件解析。记住要使用正确的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Type 类型设定</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">当包含跨域资源时</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">在许多场景里（特别是处理脚本、样式表、字体和某些插件处理的内容时），其实就把当前站点的安全性与这些子资源所在的原站点安全性关联起来了。如果</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">有疑问</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，宁可做一个本地备份再使用。在</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTPS 站点里</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，所有的子资源也都要使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTPS 协议</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">当处理</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">JavaScript 里的跨域通信时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">不要使用基于 location.hash</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><a href="http://window.name" style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">window.name</a><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">frameElements 和其他临时的处理方式</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，除非</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">有信心应对内容注入的攻击</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">不要指望站点上的子框架是一成不变的，特别是如果没有使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">X-Frame-Options 限制自己的页面不能被放置到框架里的时候</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。在某些情况下，攻击者甚至可以在用户不知情或未得到用户许可前，就把这类框架跳转到完全不同的地址上去了。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">十二</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、其他的安全边界</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">14</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期一</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">下午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">5:02</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">搭建在内部网络里的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">Web 应用时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">尽管有网络层的访问控制</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，但也要假定那些不达目的不罢休的攻击者有可能会通过受害者的浏览器与内部应用进行交互。确保</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Web 程序的设计标准要合理</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，对所有敏感应用的安全</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Cookie 都要使用 HTTPS</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，以减少基于源的渗透而导致的攻击。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">启用非</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">HTTP 服务</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">，特别是使用非标准商品启用此类</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">服务时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">需要预先评估浏览器如果无意中把 HTTP 请求发给该服务以及浏览器如果把服务器返回的响应当成 HTTP/0.9 解析后会带来什么影响</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。对于可能会被利用的协议，可以考虑在收到以“</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">GET</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">”或者</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">“POST”字样开始的请求时</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，立刻断开</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">连接作为预防的措施</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">允许组件页面或沙盒内容使用第三方</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">Cookie 时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">如果需要支持 Internet Explorer 浏览器</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，请考虑使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">P3P 策略</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">（并评估其法律效应）。如果需要支持</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Safari</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，可能需要寻找替代的身份存储方案（例如</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTML5 里的 localStorage</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">）</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">十三</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、内容识别机制</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">14</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期一</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">下午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">5:42</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">对所有网站</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">都适用的良好习惯</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">在 WEB 服务器里对所有 HTTP 响应都添加 X-Content-Options: nosniff 头域</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">设置合理的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">/crossdoamin.xml 文件</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">配置 WEB 服务器</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，对所有响应都加入默认的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">charset 和 Content-Type 值</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，以避免没有默认编码设置的情况。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">如果不需要用到基于</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Path 的参数值</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">（例如</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">PATH_INFO</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">），建议还是禁用这项功能吧。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; color: rgb(63, 63, 63); font-weight: bold;-en-paragraph:true;">产生的文档里有部分内容可由攻击者控制时</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">总是返回一个明确、有效和常用的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Type 类型</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。不要设置为</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">text/plain 或 application/octet-stream</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">在任何文本格式文档的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Type 响应头里</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，都应该设置一个明确、有效和常用的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">charset 参数值</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">；在各种可变宽度编码里，应首选</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">UTF-8</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。不要假定</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">application/xml+svg</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">text/csv 和其他非 HTML 类型的文件就不需要设定字符集了</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。对于</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTML 文档</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，如果认为文件有可能会被用户下载，还要考虑添加冗余</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">的 &lt;meta&gt; 指令</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。要注意不要输错了编码类型，</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">UTF8 并不是 UTF-8 的有效别名</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">对包括</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">JSON 数据这类不需要直接显示内容的响应</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，请使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Disposition:attachment 响应头并设定合理且明确的文件名</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">不要允许用户控制文件开头的几个字节。尽量限制</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">返回的响应内容</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。除非绝对必要，不要传输</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">NULL 空字符</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">、控制字符，除非绝对必要，也不要传输高位字符。</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">在服务器端做编码转换时，拒绝所有意料之外</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">或无效的输入</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">（譬如，过长编码的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">UTF-8 字符</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">）。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">存放用户提供的文件时</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 尽量使用沙盒域名</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。如果确实需要存放不受限制或未知的文件格式，就必须使用沙盒域名。否则，至少要做以下处理：</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Disposition: attachement 响应头</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，搭配与</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Type 参数相匹配的恰当且明确的文件名</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">仔细校验</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">输入的数据</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，总是使用便于识别的恰当</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">MIME 类型</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。把</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">JPEG 文件的类型设置为 image/gif 可能会导致问题</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。尽量避免用到常见浏览器不支持的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">MIME type 类型</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">避免使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Type: application/octet-stream</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，要用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">application/binary</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，特别是对未知的文档类型。避免返回</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Type: text/plain</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。不要允许用户设定</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Content-Type 响应头</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">十四</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、应对恶意脚本</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">15</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期二</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">上午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">11:36</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 14pt; font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">当允许用户创建的</span><span style="font-size: 14pt;-en-paragraph:true;"> </span><span style="font-size: 14pt; font-weight: bold; font-family: Calibri;-en-paragraph:true;">&lt;iframe&gt;</span><span style="font-size: 14pt;-en-paragraph:true;"> </span><span style="font-size: 14pt; font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">页面组件出现在网站上时</span><span style="font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">请尽量不要这么做</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，除非真的做好准备，能承受任何后果。因为没法可靠地阻止恶意页面对用户发起</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">DoS 攻击</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。任何这种页面组件都可能带来各种隐私的对话框，实在很难区分这些对话框到底</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">是用户在访问的页面本身弹出的呢</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，还是由那些页面组件对应的外站带进来的？</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">当创建安全要求高的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">UI 时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">由于 UI 竞争条件的风</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">险，尽量避免一个简单的按键或点击就能修改某个关键性设置的情况。要求最少两步的操作（例如要先点击一个复选框，然后再点击“保存”按扭）。如果一定要用一次点击生效的动作，考虑检查其他的信号：譬如鼠标在</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">500 毫秒前</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，是否也位于当前窗口？</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">十五</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、外围的网站</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">特权</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">16</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期三</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">下午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">4:50</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">当</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">Web 应用要求提升权限时</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 请谨记于心</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">：要访问地理位置数据、视频或麦克风提供的信息以及其他特权</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">API</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，都是需要承担责任的。如果站点可能有</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">XSS 风险</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，允许权限提升不但是在拿应用的数据赌博，同时也会搭上用户的隐私。对特权功能要提前计划好并划分清楚。不要请求用户降低</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">IE 浏览器的安全设置以适应具体的 Web 应用</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，也不要听众任何人降低浏览器权限的要求——无论他们是什么身份。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 14pt; font-weight: bold;-en-paragraph:true;">当创建会需要用到特权源的插件或扩展时</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 由于无法避免的 Web 应用安全缺陷</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，这么做会增加用户的安全风险。设计的</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">API 要可靠</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，尽量使用辅助的安全手段，譬如加密算法，以进一步加固和服务器的通信。不要对非加密源设置白名单，因为非加密站点在公开的无线网络里很容易受到攻击。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="font-size: 20pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei Light&quot;;-en-paragraph:true;">十六</span><span style="font-size: 20pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">、新的浏览器安全特性与未来展望</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">2020</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">年</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">12</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">月</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">16</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">日 星期三</span></div><div style="font-size: 10pt; color: rgb(118, 118, 118); margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">下午</span><span style="font-size: 10pt; color: rgb(118, 118, 118); font-family: Calibri;-en-paragraph:true;">4:58</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;"> 
</span></div><div style="direction: ltr; unicode-bidi: embed;"><div style="color: rgb(0, 0, 0); font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-size: 11pt; font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">跨域</span><span style="color: rgb(0, 0, 0); font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-weight: bold; font-family: Calibri;-en-paragraph:true;">XMLHttpRequest</span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">（</span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">CROS</span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-weight: bold; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">）：</span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">相当安全，但容易误用。避免使用非简单请求，不要允许设置做生意请求头或</span><span style="color: rgb(0, 0, 0); font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">HTTP 方法</span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">。如果有服务器端应用框架的控制权，可以考虑对</span><span style="color: rgb(0, 0, 0); font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">Origin 值不在白名单列表内的请求</span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">，自动地不返回</span><span style="color: rgb(0, 0, 0); font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">Cookie 头域</span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">，以尽量降低无意中导致的用户数据共享。为了尽可能减少混合内容带来的问题，可以考虑拒绝在任何明文</span><span style="color: rgb(0, 0, 0); font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">HTTP 请求里设置的 HTTPS Origin 值</span><span style="color: rgb(0, 0, 0); font-size: 11pt; font-family: &quot;Microsoft YaHei&quot;;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-size: 11pt;-en-paragraph:true;">
</span></div><div style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; mso-spacerun: yes;-en-paragraph:true;">     </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> 避免使用 Access-Control-Allow-Origin: *</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，如果真的打算这么用，一定要确保只返回给那些确实需要提供共享数据的页面。</span><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">XDomainRequest</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">使用相当安全。与</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">XMLHttpRequest 类似</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，需要限制在</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTP 的情况下该 API 使用 HTTPS 形式的源</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，以确保不会引入</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">混合内容的风险</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">内容安全策略：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">可以安全使用的深度防御机制。警示</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">script-src 和 object-src 等指令彼此交互时的影响</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，以及允许</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">data: 源会带来的危害</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。不要无意间允许混合内容：在规则集里一定要明确设定使用协议名称，并确保它们与请求页面的协议相吻合。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">沙盒框架：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">以这种方式嵌入来自其他源的页面小组件是安全的做法，但在不支持该协议的浏览器里就完全没效果了。不要把同源的文件放到沙盒里。
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">严格传输安全（</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">Strict Transport Security</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">）：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">可以安全使用的深度防御机制。确保所有相关的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Cookie 都已经被标记为 secure 属性</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，要预防通过使用真实域名，假冒非</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">STS 网址</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，从而导致的</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">Cookie 注入</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。在适宜的地方使用</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">includeSubDomains 以消除此类风险</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">toStaticHTML(...)</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">如果能用，这个函数是安全的，但在不支持该函数的浏览器里就没有替代的做法了。由于这个过滤机制</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">自身的设计问题</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">，这个</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">API 还是有颇高的几率会导致被绕过的风险</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">隐私浏览：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">出于安全的考虑，不要依赖于该机制。
</span></div><div style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">XSS 过滤</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt; font-weight: bold;-en-paragraph:true;">：</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">出于安全考虑，不要依赖于该机制。应该在</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;"> </span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">HTTP 响应头里明确设定 XSS-Protection: 1; mode=block 或 XSS-Protection: 0</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">。默认值实际上颇为不安全。</span><span style="color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-size: 11pt;-en-paragraph:true;">
</span></div></div><div><br/></div></span>
</div></body></html> 